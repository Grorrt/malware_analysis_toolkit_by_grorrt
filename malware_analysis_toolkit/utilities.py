# (Utility functions)

import hashlib 
import requests

def CalculateHashes(filepath):
    """
    Calculate MD5, SHA-1, and SHA-256 hashes for a given file.
    :param file_path: Path to the file.
    :return: Dictionary with hash values.
    """
    hashes = {'md5': hashlib.md5(), 'sha1': hashlib.sha1(), 'sha256': hashlib.sha256()}
    with open(filepath, 'rb') as f:
        while chunk := f.read(8192):
            for algo in hashes.values():
                algo.update(chunk)
    return {name: algo.hexdigest() for name, algo in hashes.items()}

def UploadToVirustotal(filepath, apikey):
    """
    Upload a file to VirusTotal for analysis.
    :param file_path: Path to the file.
    :param api_key: VirusTotal API key.
    :return: VirusTotal API response.
    """
    url = "https://www.virustotal.com/api/v3/files"
    headers = {"x-apikey": apikey}
    with open(filepath, 'rb') as f:
        files = {"file": (filepath, f)}
        response = requests.post(url, headers=headers, files=files)
    return response.json()
